<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Link y to the time scale of x — link • mpathsenser</title><!-- favicons --><link rel="icon" type="image/png" sizes="96x96" href="../favicon-96x96.png"><link rel="icon" type="”image/svg+xml”" href="../favicon.svg"><link rel="apple-touch-icon" sizes="180x180" href="../apple-touch-icon.png"><link rel="icon" sizes="any" href="../favicon.ico"><link rel="manifest" href="../site.webmanifest"><script src="../lightswitch.js"></script><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><link href="../extra.css" rel="stylesheet"><meta property="og:title" content="Link y to the time scale of x — link"><meta name="description" content="
One of the key tasks in analysing mobile sensing data is being able to link it to other data.
For example, when analysing physical activity data, it could be of interest to know how much
time a participant spent exercising before or after an ESM beep to evaluate their stress level.
link() allows you to map two data frames to each other that are on different time scales,
based on a pre-specified offset before and/or after. This function assumes that both x and
y have a column called time containing DateTimeClasses."><meta property="og:description" content="
One of the key tasks in analysing mobile sensing data is being able to link it to other data.
For example, when analysing physical activity data, it could be of interest to know how much
time a participant spent exercising before or after an ESM beep to evaluate their stress level.
link() allows you to map two data frames to each other that are on different time scales,
based on a pre-specified offset before and/or after. This function assumes that both x and
y have a column called time containing DateTimeClasses."><meta property="og:image" content="https://koenniem.github.io/mpathsenser/logo.png"><meta name="robots" content="noindex"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top " aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">mpathsenser</a>

    <small class="nav-text text-danger me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="In-development version">1.2.4.9000</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item"><a class="nav-link" href="../articles/mpathsenser.html">Get started</a></li>
<li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/data-overview.html">Data overview</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-lightswitch" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true" aria-label="Light switch"><span class="fa fa-sun"></span></button>
  <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="dropdown-lightswitch"><li><button class="dropdown-item" data-bs-theme-value="light"><span class="fa fa-sun"></span> Light</button></li>
    <li><button class="dropdown-item" data-bs-theme-value="dark"><span class="fa fa-moon"></span> Dark</button></li>
    <li><button class="dropdown-item" data-bs-theme-value="auto"><span class="fa fa-adjust"></span> Auto</button></li>
  </ul></li>
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://cloud.r-project.org/package=mpathsenser" aria-label="View on CRAN"><span class="fa fab fa-r-project"></span></a></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/koenniem/mpathsenser" aria-label="Github"><span class="fa fa-github"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Link y to the time scale of x</h1>
      <small class="dont-index">Source: <a href="https://github.com/koenniem/mpathsenser/tree/master/R/linking.R" class="external-link"><code>R/linking.R</code></a></small>
      <div class="d-none name"><code>link.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p><a href="https://lifecycle.r-lib.org/articles/stages.html#stable" class="external-link"><img src="figures/lifecycle-stable.svg" alt="[Stable]"></a></p>
<p>One of the key tasks in analysing mobile sensing data is being able to link it to other data.
For example, when analysing physical activity data, it could be of interest to know how much
time a participant spent exercising before or after an ESM beep to evaluate their stress level.
<code>link()</code> allows you to map two data frames to each other that are on different time scales,
based on a pre-specified offset before and/or after. This function assumes that both <code>x</code> and
<code>y</code> have a column called <code>time</code> containing <a href="https://rdrr.io/r/base/DateTimeClasses.html" class="external-link">DateTimeClasses</a>.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">link</span><span class="op">(</span></span>
<span>  <span class="va">x</span>,</span>
<span>  <span class="va">y</span>,</span>
<span>  by <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  <span class="va">time</span>,</span>
<span>  end_time <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  <span class="va">y_time</span>,</span>
<span>  offset_before <span class="op">=</span> <span class="fl">0</span>,</span>
<span>  offset_after <span class="op">=</span> <span class="fl">0</span>,</span>
<span>  add_before <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  add_after <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  name <span class="op">=</span> <span class="st">"data"</span>,</span>
<span>  split <span class="op">=</span> <span class="va">by</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-x-y">x, y<a class="anchor" aria-label="anchor" href="#arg-x-y"></a></dt>
<dd><p>A pair of data frames or data frame extensions (e.g. a tibble). Both <code>x</code> and <code>y</code> must
have a column called <code>time</code>.</p></dd>


<dt id="arg-by">by<a class="anchor" aria-label="anchor" href="#arg-by"></a></dt>
<dd><p>A character vector indicating the variable(s) to match by, typically the participant
IDs. If NULL, the default, <code>*_join()</code> will perform a natural join, using all variables in
common across <code>x</code> and <code>y</code>. Therefore, all data will be mapped to each other based on the time
stamps of <code>x</code> and <code>y</code>. A message lists the variables so that you can check they're correct;
suppress the message by supplying by explicitly.</p>
<p>To join by different variables on <code>x</code> and <code>y</code>, use a named vector. For example, <code>by = c('a' = 'b')</code> will match <code>x$a</code> to <code>y$b</code>.</p>
<p>To join by multiple variables, use a vector with <code>length &gt; 1</code>. For example, <code>by = c('a', 'b')</code>
will match <code>x$a</code> to <code>y$a</code> and <code>x$b</code> to <code>y$b</code>. Use a named vector to match different variables
in <code>x</code> and <code>y</code>. For example, <code>by = c('a' = 'b', 'c' = 'd')</code> will match <code>x$a</code> to <code>y$b</code> and <code>x$c</code>
to <code>y$d</code>.</p>
<p>To perform a cross-join (when <code>x</code> and <code>y</code> have no variables in common), use <code>by = character()</code>.
Note that the <code>split</code> argument will then be set to 1.</p></dd>


<dt id="arg-time">time<a class="anchor" aria-label="anchor" href="#arg-time"></a></dt>
<dd><p>The name of the column containing the timestamps in <code>x</code>.</p></dd>


<dt id="arg-end-time">end_time<a class="anchor" aria-label="anchor" href="#arg-end-time"></a></dt>
<dd><p>Optionally, the name of the column containing the end time in <code>x</code>. If specified,
it means <code>time</code> defines the start time of the interval and <code>end_time</code> the end time. Note that
this cannot be used at the same time as <code>offset_before</code> or <code>offset_after</code>.</p></dd>


<dt id="arg-y-time">y_time<a class="anchor" aria-label="anchor" href="#arg-y-time"></a></dt>
<dd><p>The name of the column containing the timestamps in <code>y</code>.</p></dd>


<dt id="arg-offset-before">offset_before<a class="anchor" aria-label="anchor" href="#arg-offset-before"></a></dt>
<dd><p>The time before each measurement in <code>x</code> that denotes the period in which <code>y</code>
is matched. Must be convertible to a period by <code><a href="https://lubridate.tidyverse.org/reference/as.period.html" class="external-link">lubridate::as.period()</a></code>.</p></dd>


<dt id="arg-offset-after">offset_after<a class="anchor" aria-label="anchor" href="#arg-offset-after"></a></dt>
<dd><p>The time after each measurement in <code>x</code> that denotes the period in which <code>y</code>
is matched. Must be convertible to a period by <code><a href="https://lubridate.tidyverse.org/reference/as.period.html" class="external-link">lubridate::as.period()</a></code>.</p></dd>


<dt id="arg-add-before">add_before<a class="anchor" aria-label="anchor" href="#arg-add-before"></a></dt>
<dd><p>Logical value. Do you want to add the last measurement before the start of each
interval?</p></dd>


<dt id="arg-add-after">add_after<a class="anchor" aria-label="anchor" href="#arg-add-after"></a></dt>
<dd><p>Logical value. Do you want to add the first measurement after the end of each
interval?</p></dd>


<dt id="arg-name">name<a class="anchor" aria-label="anchor" href="#arg-name"></a></dt>
<dd><p>The name of the column containing the nested <code>y</code> data.</p></dd>


<dt id="arg-split">split<a class="anchor" aria-label="anchor" href="#arg-split"></a></dt>
<dd><p>An optional grouping variable to split the computation by. When working with large
data sets, the computation can grow so large it no longer fits in your computer's working
memory (after which it will probably fall back on the swap file, which is very slow). Splitting
the computation trades some computational efficiency for a large decrease in RAM usage. This
argument defaults to <code>by</code> to automatically suppress some of its RAM usage.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>A tibble with the data of <code>x</code> with a new column <code>data</code> with the matched data of <code>y</code>
according to <code>offset_before</code> and <code>offset_after</code>.</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p><code>y</code> is matched to the time scale of <code>x</code> by means of time windows. These time windows are
defined as the period between <code>x - offset_before</code> and <code>x + offset_after</code>. Note that either
<code>offset_before</code> or <code>offset_after</code> can be 0, but not both. The "interval" of the measurements is
therefore the associated time window for each measurement of <code>x</code> and the data of <code>y</code> that also
falls within this period. For example, an <code>offset_before</code>  of
<code><a href="https://lubridate.tidyverse.org/reference/period.html" class="external-link">minutes</a>(30)</code> means to match all data of <code>y</code> that occurred <em>before</em> each
measurement in <code>x</code>. An <code>offset_after</code> of 900 (i.e. 15 minutes) means to match all data of <code>y</code>
that occurred <em>after</em> each measurement in <code>x</code>. When both <code>offset_before</code> and <code>offset_after</code> are
specified, it means all data of <code>y</code> is matched in an interval of 30 minutes before and 15
minutes after each measurement of <code>x</code>, thus combining the two arguments.</p>
<p>The arguments <code>add_before</code> and <code>add_after</code> let you decide whether you want to add the last
measurement before the interval and/or the first measurement after the interval respectively.
This could be useful when you want to know which type of event occurred right before or after
the interval of the measurement. For example, at <code>offset_before = "30 minutes"</code>, the data may
indicate that a participant was running 20 minutes before a measurement in <code>x</code>, However, with
just that information there is no way of knowing what the participant was doing the first 10
minutes of the interval. The same principle applies to after the interval. When <code>add_before</code> is
set to <code>TRUE</code>, the last measurement of <code>y</code> occurring before the interval of <code>x</code> is added to the
output data as the first row, having the <strong><code>time</code> of <code>x - offset_before</code></strong> (i.e. the start
of the interval). When <code>add_after</code> is set to <code>TRUE</code>, the first measurement of <code>y</code> occurring
after the interval of <code>x</code> is added to the output data as the last row, having the <strong><code>time</code> of
<code>x + offset_after</code></strong> (i.e. the end of the interval). This way, it is easier to calculate the
difference to other measurements of <code>y</code> later (within the same interval). Additionally, an
extra column (<code>original_time</code>) is added in the nested <code>data</code> column, which is the original time
of the <code>y</code> measurement and <code>NULL</code> for every other observation. This may be useful to check if
the added measurement isn't too distant (in time) from the others. Note that multiple rows may
be added if there were multiple measurements in <code>y</code> at exactly the same time. Also, if there
already is a row with a timestamp exactly equal to the start of the interval (for <code>add_before = TRUE</code>) or to the end of the interval <code>(add_after = TRUE</code>), no extra row is added.</p>
    </div>
    <div class="section level2">
    <h2 id="warning">Warning<a class="anchor" aria-label="anchor" href="#warning"></a></h2>
    <p>Note that setting <code>add_before</code> and <code>add_after</code> each add one row to each nested
<code>tibble</code> of the <code>data</code> column. Thus, if you are only interested in the total count (e.g.
the number of total screen changes), remember to set these arguments to FALSE or make sure to
filter out rows that do <em>not</em> have an <code>original_time</code>. Simply subtracting 1 or 2 does not work
as not all measurements in <code>x</code> may have a measurement in <code>y</code> before or after (and thus no row
is added).</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co"># Define some data</span></span></span>
<span class="r-in"><span><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>  time <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/seq.POSIXt.html" class="external-link">seq.POSIXt</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/as.POSIXlt.html" class="external-link">as.POSIXct</a></span><span class="op">(</span><span class="st">"2021-11-14 13:00:00"</span><span class="op">)</span>, by <span class="op">=</span> <span class="st">"1 hour"</span>, length.out <span class="op">=</span> <span class="fl">3</span><span class="op">)</span>, <span class="fl">2</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  participant_id <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="st">"12345"</span>, <span class="fl">3</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="st">"23456"</span>, <span class="fl">3</span><span class="op">)</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  item_one <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">40</span>, <span class="fl">50</span>, <span class="fl">60</span><span class="op">)</span>, <span class="fl">2</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Define some data that we want to link to x</span></span></span>
<span class="r-in"><span><span class="va">y</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>  time <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/seq.POSIXt.html" class="external-link">seq.POSIXt</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/as.POSIXlt.html" class="external-link">as.POSIXct</a></span><span class="op">(</span><span class="st">"2021-11-14 12:50:00"</span><span class="op">)</span>, by <span class="op">=</span> <span class="st">"5 min"</span>, length.out <span class="op">=</span> <span class="fl">30</span><span class="op">)</span>, <span class="fl">2</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  participant_id <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="st">"12345"</span>, <span class="fl">30</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="st">"23456"</span>, <span class="fl">30</span><span class="op">)</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">30</span>, <span class="fl">2</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Now link y within 30 minutes before each row in x</span></span></span>
<span class="r-in"><span><span class="co"># until the measurement itself:</span></span></span>
<span class="r-in"><span><span class="fu">link</span><span class="op">(</span></span></span>
<span class="r-in"><span>  x <span class="op">=</span> <span class="va">x</span>,</span></span>
<span class="r-in"><span>  y <span class="op">=</span> <span class="va">y</span>,</span></span>
<span class="r-in"><span>  by <span class="op">=</span> <span class="st">"participant_id"</span>,</span></span>
<span class="r-in"><span>  time <span class="op">=</span> <span class="va">time</span>,</span></span>
<span class="r-in"><span>  y_time <span class="op">=</span> <span class="va">time</span>,</span></span>
<span class="r-in"><span>  offset_before <span class="op">=</span> <span class="st">"30 minutes"</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># A tibble: 6 × 4</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   time                participant_id item_one data            </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dttm&gt;</span>              <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>             <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;list&gt;</span>          </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">1</span> 2021-11-14 <span style="color: #949494;">13:00:00</span> 12345                40 <span style="color: #949494;">&lt;tibble [3 × 2]&gt;</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">2</span> 2021-11-14 <span style="color: #949494;">14:00:00</span> 12345                50 <span style="color: #949494;">&lt;tibble [7 × 2]&gt;</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">3</span> 2021-11-14 <span style="color: #949494;">15:00:00</span> 12345                60 <span style="color: #949494;">&lt;tibble [7 × 2]&gt;</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">4</span> 2021-11-14 <span style="color: #949494;">13:00:00</span> 23456                40 <span style="color: #949494;">&lt;tibble [3 × 2]&gt;</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">5</span> 2021-11-14 <span style="color: #949494;">14:00:00</span> 23456                50 <span style="color: #949494;">&lt;tibble [7 × 2]&gt;</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">6</span> 2021-11-14 <span style="color: #949494;">15:00:00</span> 23456                60 <span style="color: #949494;">&lt;tibble [7 × 2]&gt;</span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># We can also link y to a period both before and after</span></span></span>
<span class="r-in"><span><span class="co"># each measurement in x.</span></span></span>
<span class="r-in"><span><span class="co"># Also note that time, end_time and y_time accept both</span></span></span>
<span class="r-in"><span><span class="co"># quoted names as well as character names.</span></span></span>
<span class="r-in"><span><span class="fu">link</span><span class="op">(</span></span></span>
<span class="r-in"><span>  x <span class="op">=</span> <span class="va">x</span>,</span></span>
<span class="r-in"><span>  y <span class="op">=</span> <span class="va">y</span>,</span></span>
<span class="r-in"><span>  by <span class="op">=</span> <span class="st">"participant_id"</span>,</span></span>
<span class="r-in"><span>  time <span class="op">=</span> <span class="st">"time"</span>,</span></span>
<span class="r-in"><span>  y_time <span class="op">=</span> <span class="st">"time"</span>,</span></span>
<span class="r-in"><span>  offset_before <span class="op">=</span> <span class="st">"15 minutes"</span>,</span></span>
<span class="r-in"><span>  offset_after <span class="op">=</span> <span class="st">"15 minutes"</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># A tibble: 6 × 4</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   time                participant_id item_one data            </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dttm&gt;</span>              <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>             <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;list&gt;</span>          </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">1</span> 2021-11-14 <span style="color: #949494;">13:00:00</span> 12345                40 <span style="color: #949494;">&lt;tibble [6 × 2]&gt;</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">2</span> 2021-11-14 <span style="color: #949494;">14:00:00</span> 12345                50 <span style="color: #949494;">&lt;tibble [7 × 2]&gt;</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">3</span> 2021-11-14 <span style="color: #949494;">15:00:00</span> 12345                60 <span style="color: #949494;">&lt;tibble [7 × 2]&gt;</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">4</span> 2021-11-14 <span style="color: #949494;">13:00:00</span> 23456                40 <span style="color: #949494;">&lt;tibble [6 × 2]&gt;</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">5</span> 2021-11-14 <span style="color: #949494;">14:00:00</span> 23456                50 <span style="color: #949494;">&lt;tibble [7 × 2]&gt;</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">6</span> 2021-11-14 <span style="color: #949494;">15:00:00</span> 23456                60 <span style="color: #949494;">&lt;tibble [7 × 2]&gt;</span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># It can be important to also know the measurements</span></span></span>
<span class="r-in"><span><span class="co"># just preceding the interval or just after the interval.</span></span></span>
<span class="r-in"><span><span class="co"># This adds an extra column called 'original_time' in the</span></span></span>
<span class="r-in"><span><span class="co"># nested data, containing the original time stamp. The</span></span></span>
<span class="r-in"><span><span class="co"># actual timestamp is set to the start time of the interval.</span></span></span>
<span class="r-in"><span><span class="fu">link</span><span class="op">(</span></span></span>
<span class="r-in"><span>  x <span class="op">=</span> <span class="va">x</span>,</span></span>
<span class="r-in"><span>  y <span class="op">=</span> <span class="va">y</span>,</span></span>
<span class="r-in"><span>  by <span class="op">=</span> <span class="st">"participant_id"</span>,</span></span>
<span class="r-in"><span>  time <span class="op">=</span> <span class="va">time</span>,</span></span>
<span class="r-in"><span>  y_time <span class="op">=</span> <span class="va">time</span>,</span></span>
<span class="r-in"><span>  offset_before <span class="op">=</span> <span class="st">"15 minutes"</span>,</span></span>
<span class="r-in"><span>  offset_after <span class="op">=</span> <span class="st">"15 minutes"</span>,</span></span>
<span class="r-in"><span>  add_before <span class="op">=</span> <span class="cn">TRUE</span>,</span></span>
<span class="r-in"><span>  add_after <span class="op">=</span> <span class="cn">TRUE</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># A tibble: 6 × 4</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   time                participant_id item_one data            </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dttm&gt;</span>              <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>             <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;list&gt;</span>          </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">1</span> 2021-11-14 <span style="color: #949494;">13:00:00</span> 12345                40 <span style="color: #949494;">&lt;tibble [6 × 3]&gt;</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">2</span> 2021-11-14 <span style="color: #949494;">14:00:00</span> 12345                50 <span style="color: #949494;">&lt;tibble [7 × 3]&gt;</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">3</span> 2021-11-14 <span style="color: #949494;">15:00:00</span> 12345                60 <span style="color: #949494;">&lt;tibble [7 × 3]&gt;</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">4</span> 2021-11-14 <span style="color: #949494;">13:00:00</span> 23456                40 <span style="color: #949494;">&lt;tibble [6 × 3]&gt;</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">5</span> 2021-11-14 <span style="color: #949494;">14:00:00</span> 23456                50 <span style="color: #949494;">&lt;tibble [7 × 3]&gt;</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">6</span> 2021-11-14 <span style="color: #949494;">15:00:00</span> 23456                60 <span style="color: #949494;">&lt;tibble [7 × 3]&gt;</span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># If you participant_id is not important to you</span></span></span>
<span class="r-in"><span><span class="co"># (i.e. the measurements are interchangeable),</span></span></span>
<span class="r-in"><span><span class="co"># you can ignore them by leaving by empty.</span></span></span>
<span class="r-in"><span><span class="co"># However, in this case we'll receive a warning</span></span></span>
<span class="r-in"><span><span class="co"># since x and y have no other columns in common</span></span></span>
<span class="r-in"><span><span class="co"># (except time, of course). Thus, we can perform</span></span></span>
<span class="r-in"><span><span class="co"># a cross-join:</span></span></span>
<span class="r-in"><span><span class="fu">link</span><span class="op">(</span></span></span>
<span class="r-in"><span>  x <span class="op">=</span> <span class="va">x</span>,</span></span>
<span class="r-in"><span>  y <span class="op">=</span> <span class="va">y</span>,</span></span>
<span class="r-in"><span>  by <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/character.html" class="external-link">character</a></span><span class="op">(</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  time <span class="op">=</span> <span class="va">time</span>,</span></span>
<span class="r-in"><span>  y_time <span class="op">=</span> <span class="va">time</span>,</span></span>
<span class="r-in"><span>  offset_before <span class="op">=</span> <span class="st">"30 minutes"</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># A tibble: 6 × 4</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   time                participant_id item_one data             </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dttm&gt;</span>              <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>             <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;list&gt;</span>           </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">1</span> 2021-11-14 <span style="color: #949494;">13:00:00</span> 12345                40 <span style="color: #949494;">&lt;tibble [6 × 3]&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">2</span> 2021-11-14 <span style="color: #949494;">14:00:00</span> 12345                50 <span style="color: #949494;">&lt;tibble [14 × 3]&gt;</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">3</span> 2021-11-14 <span style="color: #949494;">15:00:00</span> 12345                60 <span style="color: #949494;">&lt;tibble [14 × 3]&gt;</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">4</span> 2021-11-14 <span style="color: #949494;">13:00:00</span> 23456                40 <span style="color: #949494;">&lt;tibble [6 × 3]&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">5</span> 2021-11-14 <span style="color: #949494;">14:00:00</span> 23456                50 <span style="color: #949494;">&lt;tibble [14 × 3]&gt;</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">6</span> 2021-11-14 <span style="color: #949494;">15:00:00</span> 23456                60 <span style="color: #949494;">&lt;tibble [14 × 3]&gt;</span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Alternatively, we can specify custom intervals.</span></span></span>
<span class="r-in"><span><span class="co"># That is, we can create variable intervals</span></span></span>
<span class="r-in"><span><span class="co"># without using fixed offsets.</span></span></span>
<span class="r-in"><span><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>  start_time <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>    x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/as.POSIXlt.html" class="external-link">as.POSIXct</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>      <span class="st">"2021-11-14 12:40:00"</span>,</span></span>
<span class="r-in"><span>      <span class="st">"2021-11-14 13:30:00"</span>,</span></span>
<span class="r-in"><span>      <span class="st">"2021-11-14 15:00:00"</span></span></span>
<span class="r-in"><span>    <span class="op">)</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    times <span class="op">=</span> <span class="fl">2</span></span></span>
<span class="r-in"><span>  <span class="op">)</span>,</span></span>
<span class="r-in"><span>  end_time <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>    x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/as.POSIXlt.html" class="external-link">as.POSIXct</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>      <span class="st">"2021-11-14 13:20:00"</span>,</span></span>
<span class="r-in"><span>      <span class="st">"2021-11-14 14:10:00"</span>,</span></span>
<span class="r-in"><span>      <span class="st">"2021-11-14 15:30:00"</span></span></span>
<span class="r-in"><span>    <span class="op">)</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    times <span class="op">=</span> <span class="fl">2</span></span></span>
<span class="r-in"><span>  <span class="op">)</span>,</span></span>
<span class="r-in"><span>  participant_id <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="st">"12345"</span>, <span class="fl">3</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="st">"23456"</span>, <span class="fl">3</span><span class="op">)</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  item_one <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">40</span>, <span class="fl">50</span>, <span class="fl">60</span><span class="op">)</span>, <span class="fl">2</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu">link</span><span class="op">(</span></span></span>
<span class="r-in"><span>  x <span class="op">=</span> <span class="va">x</span>,</span></span>
<span class="r-in"><span>  y <span class="op">=</span> <span class="va">y</span>,</span></span>
<span class="r-in"><span>  by <span class="op">=</span> <span class="st">"participant_id"</span>,</span></span>
<span class="r-in"><span>  time <span class="op">=</span> <span class="va">start_time</span>,</span></span>
<span class="r-in"><span>  end_time <span class="op">=</span> <span class="va">end_time</span>,</span></span>
<span class="r-in"><span>  y_time <span class="op">=</span> <span class="va">time</span>,</span></span>
<span class="r-in"><span>  add_before <span class="op">=</span> <span class="cn">TRUE</span>,</span></span>
<span class="r-in"><span>  add_after <span class="op">=</span> <span class="cn">TRUE</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># A tibble: 6 × 5</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   start_time          end_time            participant_id item_one data    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dttm&gt;</span>              <span style="color: #949494; font-style: italic;">&lt;dttm&gt;</span>              <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>             <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;list&gt;</span>  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">1</span> 2021-11-14 <span style="color: #949494;">12:40:00</span> 2021-11-14 <span style="color: #949494;">13:20:00</span> 12345                40 <span style="color: #949494;">&lt;tibble&gt;</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">2</span> 2021-11-14 <span style="color: #949494;">13:30:00</span> 2021-11-14 <span style="color: #949494;">14:10:00</span> 12345                50 <span style="color: #949494;">&lt;tibble&gt;</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">3</span> 2021-11-14 <span style="color: #949494;">15:00:00</span> 2021-11-14 <span style="color: #949494;">15:30:00</span> 12345                60 <span style="color: #949494;">&lt;tibble&gt;</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">4</span> 2021-11-14 <span style="color: #949494;">12:40:00</span> 2021-11-14 <span style="color: #949494;">13:20:00</span> 23456                40 <span style="color: #949494;">&lt;tibble&gt;</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">5</span> 2021-11-14 <span style="color: #949494;">13:30:00</span> 2021-11-14 <span style="color: #949494;">14:10:00</span> 23456                50 <span style="color: #949494;">&lt;tibble&gt;</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">6</span> 2021-11-14 <span style="color: #949494;">15:00:00</span> 2021-11-14 <span style="color: #949494;">15:30:00</span> 23456                60 <span style="color: #949494;">&lt;tibble&gt;</span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by <a href="https://ppw.kuleuven.be/okp/team/Koen_Niemeijer/" class="external-link">Koen Niemeijer</a>, KU Leuven.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.2.0.</p>
</div>

    </footer></div>





  </body></html>

